<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="تحدث مع مساعد كرة القدم الذكي Football 3D AI. احصل على تحليلات فورية، توقعات للمباريات، ومقارنات بين اللاعبين باستخدام الذكاء الاصطناعي.">
<meta name="keywords" content="خبير كرة قدم, ذكاء اصطناعي, تحليل مباريات, توقعات, AI football expert, football chat, Football 3D AI">
<title>Football 3D AI - نونو شات متخصص بكرة القدم</title>

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" href="/favicon.ico" sizes="any">
<meta name="theme-color" content="#111827">
<meta property="og:image" content="https://football3.netlify.app/logo.png">
<meta property="og:title" content="Football 3D AI - مساعدك الذكي">
<meta property="og:description" content="تحدث مع مساعد كرة القدم الذكي. احصل على تحليلات فورية، توقعات للمباريات، ومقارنات بين اللاعبين.">
<meta property="og:url" content="https://football3.netlify.app/football-ai.html">
<meta name="twitter:card" content="summary_large_image">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
/* إضافة خلفية رياضية أنيقة للصفحة */
.ai-page-body {
background-image: linear-gradient(rgba(17, 24, 39, 0.95), rgba(17, 24, 39, 0.95)), url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23374151' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
/* تصميم رأس الشات الجديد */
.chat-header-status {
padding: 15px 20px;
background-color: rgba(31, 41, 55, 0.7);
border-bottom: 1px solid rgba(75, 85, 99, 0.5);
display: flex;
align-items: center;
gap: 15px;
}
.chat-header-status .avatar {
font-size: 24px;
color: #34d399; /* أخضر زاهي */
}
.chat-header-status .status-indicator {
width: 10px; height: 10px; background-color: #34d399; border-radius: 50%;
box-shadow: 0 0 8px #34d399;
}

/* تنسيقات إضافية للرسائل */
.chat-messages {
display: flex;
flex-direction: column;
padding: 15px;
overflow-y: auto;
flex-grow: 1;
}
.message-box {
max-width: 80%;
margin-bottom: 10px;
padding: 10px 15px;
border-radius: 15px;
line-height: 1.5;
word-wrap: break-word;
font-size: 0.95rem;
}
.user-message {
align-self: flex-end;
background-color: #3b82f6; /* أزرق */
color: white;
border-bottom-right-radius: 5px;
}
.ai-message {
align-self: flex-start;
background-color: #1f2937; /* رمادي داكن */
color: #d1d5db;
border-bottom-left-radius: 5px;
}
.loading-message {
align-self: flex-start;
background-color: #fcd34d;
color: #1f2937;
font-style: italic;
}
.search-indicator {
align-self: flex-start;
background-color: #a5f3fc;
color: #064e3b;
font-size: 0.85rem;
padding: 8px 12px;
border-radius: 10px;
margin-bottom: 10px;
}
#send-btn:disabled {
opacity: 0.5;
cursor: not-allowed;
}
</style>
</head>
<body class="ai-page-body">
<header>
<div class="container">
<div class="header-content">
<div class="logo">
<div class="logo-icon"><i class="fas fa-futbol"></i></div>
<div class="logo-text">Football 3D Hub</div>
</div>
<nav>
<ul>
<li><a href="index.html"><i class="fas fa-home"></i><span data-i18n="navHome"> الرئيسية</span></a></li>
<li><a href="teams.html"><i class="fas fa-shield-alt"></i><span data-i18n="navTeams"> الفرق</span></a></li>
<li><a href="players.html"><i class="fas fa-star"></i><span data-i18n="navPlayers"> اللاعبين</span></a></li>
<li><a href="standings.html"><i class="fas fa-sort-amount-up"></i><span data-i18n="navStandings"> الترتيب</span></a></li>
<li><a href="stats.html"><i class="fas fa-chart-line"></i><span data-i18n="navStats"> الإحصائيات</span></a></li>
<li><a href="transfers.html"><i class="fas fa-random"></i><span data-i18n="navTransfers"> الانتقالات</span></a></li>
<li><a href="news.html"><i class="far fa-newspaper"></i><span data-i18n="navNews"> الأخبار</span></a></li>
<li><a href="football-ai.html"><i class="fas fa-robot"></i><span data-i18n="navAI">Football 3D AI</span></a></li>
<li><a href="contact.html"><i class="fas fa-envelope"></i><span data-i18n="navContact"> اتصل بنا</span></a></li>
</ul>
<div class="nav-controls">
<div class="theme-switch-wrapper">
<label class="theme-switch" for="theme-checkbox" title="تبديل الوضع"><input type="checkbox" id="theme-checkbox" /><div class="slider"></div></label>
</div>
<div class="world-clock-dropdown" id="world-clock-dropdown">
<button class="world-clock-trigger" title="التوقيت العالمي"><i class="fas fa-globe-americas"></i></button>
<div class="world-clock-options"></div>
</div>
<div class="language-switcher-dropdown" id="language-switcher-dropdown">
<button class="lang-switcher-trigger"></button>
<div class="lang-switcher-options"></div>
</div>
</div>
</nav>
</div>
</div>
</header>

<main class="ai-page-main" id="football-ai-page">
<div class="chat-header-status">
<div class="avatar">
<i class="fas fa-robot"></i>
</div>
<div>
<h3 style="margin: 0; font-size: 1.1rem;" id="chat-title">نونو شات لكرة القدم</h3>
<div style="display: flex; align-items: center; gap: 5px; color: #9ca3af; font-size: 0.8rem;">
<span class="status-indicator"></span>
<span id="ai-status-text">متصل (Gemma + بحث ويب)</span>
</div>
</div>
</div>
<div class="chat-messages" id="chat-messages">
<div class="message-box ai-message">
مرحباً بك! أنا نونو شات، خبير كرة القدم الخاص بك. اسألني عن *نتائج مباريات اليوم، أخبار الانتقالات، أو تفاصيل أي لاعب* وسأبحث لك عن أحدث المعلومات.
</div>
</div>

<div class="chat-input-area" id="chat-input-area">
<div class="input-wrapper">
<button id="new-chat-btn" class="input-icon-btn" title="محادثة جديدة" onclick="newChat()">
<i class="fas fa-plus"></i>
</button>
<textarea id="chat-input" placeholder="اسأل نونو شات..." rows="1" onkeydown="handleKeyPress(event)"></textarea>
<button id="mic-btn" class="input-icon-btn" title="استخدام الميكروفون" disabled>
<i class="fas fa-microphone"></i>
</button>
<button id="send-btn" class="input-icon-btn send-btn-modern" title="إرسال" onclick="sendMessage()">
<i class="fas fa-arrow-up"></i>
</button>
</div>
<p class="footer-disclaimer">
قد يقدم Football 3D AI معلومات غير دقيقة أحياناً.
<a href="terms-and-conditions.html">الشروط والأحكام</a>
</p>
</div>
</main>

<footer>
<div class="container">
<div class="footer-content">
<div>
<div class="footer-logo">
<i class="fas fa-futbol"></i>
<span>Football 3D Hub</span>
</div>
<p class="footer-description">
منصة متكاملة لعشاق كرة القدم تجمع بين التحليل الرياضي الدقيق والتجربة البصرية ثلاثية الأبعاد الغامرة.
</p>
<div class="social-links">
<a href="#" class="social-link" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
<a href="#" class="social-link" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
<a href="#" class="social-link" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
<a href="#" class="social-link" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
</div>
</div>

<div>
<h3 class="footer-title" data-i18n="quickLinks">روابط سريعة</h3>
<ul class="footer-links">
<li><a href="about.html"><i class="fas fa-angle-left"></i><span data-i18n="aboutUs"> عن الموقع</span></a></li>
<li><a href="features.html"><i class="fas fa-angle-left"></i><span data-i18n="features"> المميزات</span></a></li>
<li><a href="teams.html"><i class="fas fa-angle-left"></i><span data-i18n="navTeams"> الفرق</span></a></li>
<li><a href="news.html"><i class="fas fa-angle-left"></i><span data-i18n="navNews"> الأخبار</span></a></li>
<li><a href="stats.html"><i class="fas fa-angle-left"></i><span data-i18n="navStats"> الإحصائيات</span></a></li>
<li><a href="football-ai.html"><i class="fas fa-angle-left"></i><span data-i18n="navAI">Football 3D AI</span></a></li>
<li><a href="contact.html"><i class="fas fa-angle-left"></i><span data-i18n="navContact"> اتصل بنا</span></a></li>
<li><a href="sitemap.html"><i class="fas fa-angle-left"></i> خريطة الموقع</a></li>
</ul>
</div>

<div>
<h3 class="footer-title">اتصل بنا</h3>
<ul class="footer-links">
<li><a href="mailto:football3dhub@gmail.com"><i class="fas fa-envelope"></i> football3dhub@gmail.com</a></li>
<li><a href="tel:+201279082485"><i class="fas fa-phone"></i> +20 127 908 2485</a></li>
<li><a href="contact.html"><i class="fas fa-map-marker-alt"></i> مصر</a></li>
</ul>
</div>
</div>

<div class="footer-extra-content">
<div class="footer-keywords">
<h3 class="footer-title">كلمات مفتاحية</h3>
<ul class="keywords-list">
<li>نتائج مباشرة</li>
<li>أخبار كرة القدم</li>
<li>الدوري الإنجليزي</li>
<li>الدوري الإسباني</li>
<li>دوري أبطال أوروبا</li>
<li>ترتيب الفرق</li>
<li>إحصائيات اللاعبين</li>
<li>سوق الانتقالات</li>
</ul>
</div>
</div>

<div class="footer-legal">
<ul class="footer-links">
<li><a href="privacy-policy.html">سياسة الخصوصية</a></li>
<li><a href="terms-and-conditions.html">الشروط والأحكام</a></li>
</ul>
<p class="data-source-notice">بيانات المباريات والترتيب مقدمة بواسطة <a href="https://www.api-football.com/" target="_blank" rel="noopener noreferrer">API-Football</a>.</p>
</div>

<div class="copyright">
© 2024 Football 3D Hub. جميع الحقوق محفوظة.
</div>
</div>
</footer>

<audio id="notification-sound" src="sounds/notification.mp3" preload="auto"></audio>

<div id="cookie-notice">
<p>يستخدم هذا الموقع ملفات تعريف الارتباط لضمان حصولك على أفضل تجربة. <a href="privacy-policy.html">اعرف المزيد</a></p>
<button id="cookie-accept-btn">أوافق</button>
</div>

<div class="ad-widget" id="ad-widget">
<button class="ad-widget-close" id="ad-widget-close" aria-label="إغلاق">&times;</button>
<h4><i class="fas fa-bullhorn"></i> أعلن معنا</h4>
<p>هل ترغب في الوصول إلى جمهورنا الشغوف بكرة القدم؟ تواصل معنا الآن!</p>
<div class="contact-links">
<a href="https://wa.me/201279082485" target="_blank" rel="noopener noreferrer">
<i class="fab fa-whatsapp"></i> WhatsApp
</a>
<a href="mailto:football3dhub@gmail.com">
<i class="fas fa-envelope"></i> البريد الإلكتروني
</a>
</div>
</div>

<button id="back-to-top" title="الرجوع للأعلى"><i class="fas fa-arrow-up"></i></button>

<script src="main.js?v=1.0.0" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/14.1.0/markdown-it.min.js" defer></script>

<script>
// إعدادات API والموديل
const OPENROUTER_API_KEY = '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';
const OPENROUTER_API_URL = 'https://openrouter.ai/api/v1/chat/completions';

// الموديل المفضل مع تفعيل البحث على الويب
const MODEL_NAME = 'google/gemma-3n-e4b-it:free:online';

// سجل المحادثة يبدأ بالتعليمات المتخصصة
let conversationHistory = [
{
role: "system",
content: "أنت نونو شات، خبير كرة قدم متخصص ومحدث. مهمتك هي توفير معلومات دقيقة ومحدثة حول كرة القدم فقط. يجب عليك *استخدام البحث على الويب* قبل الرد لتزويد المستخدم بـ: *نتائج مباريات اليوم الحقيقية، مواعيد مباريات اليوم والغد، أخبار الانتقالات، وتفاصيل اللاعبين المحدثة باليوم والساعة.* يجب أن يكون الرد بأسلوب ودي ومباشر وباللغة العربية. إذا سألك عن شيء خارج كرة القدم، اعتذر بأدب وذكّره بتخصصك."
}
];

let isProcessing = false;
const chatWindow = document.getElementById('chat-messages');
const inputElement = document.getElementById('chat-input');
const sendButton = document.getElementById('send-btn');
const md = new markdownit(); // تهيئة Markdown It

// ------------------------------------------------------------------
// وظائف واجهة المستخدم
// ------------------------------------------------------------------

// دالة إنشاء عنصر الرسالة
function createMessageElement(text, sender) {
const div = document.createElement('div');
div.className = message-box ${sender === 'user' ? 'user-message' : 'ai-message'};
div.innerHTML = md.render(text); // تحويل Markdown إلى HTML
return div;
}

// دالة إنشاء رسالة حالة (تحميل، بحث)
function createStatusMessage(text) {
const div = document.createElement('div');
div.className = 'search-indicator';
div.textContent = text;
return div;
}

// دالة التمرير للأسفل
function scrollToBottom() {
chatWindow.scrollTop = chatWindow.scrollHeight;
}

// دالة بدء محادثة جديدة
function newChat() {
conversationHistory = [
{
role: "system",
content: "أنت نونو شات، خبير كرة قدم متخصص ومحدث. مهمتك هي توفير معلومات دقيقة ومحدثة حول كرة القدم فقط. يجب عليك *استخدام البحث على الويب* قبل الرد لتزويد المستخدم بـ: *نتائج مباريات اليوم الحقيقية، مواعيد مباريات اليوم والغد، أخبار الانتقالات، وتفاصيل اللاعبين المحدثة باليوم والساعة.* يجب أن يكون الرد بأسلوب ودي ومباشر وباللغة العربية. إذا سألك عن شيء خارج كرة القدم، اعتذر بأدب وذكّره بتخصصك."
}
];
chatWindow.innerHTML = <div class="message-box ai-message">تم بدء محادثة جديدة. اسألني عن **مباريات اليوم** أو **آخر أخبار ميسي**!</div>;
scrollToBottom();
inputElement.focus();
}

// ------------------------------------------------------------------
// منطق إرسال الرسائل (API)
// ------------------------------------------------------------------

// معالج ضغط Enter
function handleKeyPress(event) {
if (event.key === 'Enter' && !event.shiftKey) {
event.preventDefault(); // منع سطر جديد
sendMessage();
}
}

async function sendMessage() {
if (isProcessing) return;

const messageText = inputElement.value.trim();
if (messageText === '') return;

// 1. عرض رسالة المستخدم
const userMsgDiv = createMessageElement(messageText, 'user');
chatWindow.appendChild(userMsgDiv);
inputElement.value = '';
scrollToBottom();

conversationHistory.push({ role: "user", content: messageText });

// تفعيل حالة الانتظار
isProcessing = true;
sendButton.disabled = true;

// 2. إظهار مؤشر البحث
const searchIndicator = createStatusMessage(' نونو شات يبحث على الويب عن نتائج اليوم...');
chatWindow.appendChild(searchIndicator);
scrollToBottom();

let finalResult = 'عذراً، حدث خطأ غير متوقع.';

try {
// 3. استدعاء API
const response = await fetch(OPENROUTER_API_URL, {
method: 'POST',
headers: {
'Content-Type': 'application/json',
'Authorization': Bearer ${OPENROUTER_API_KEY},
// Headers إضافية للمتابعة
'HTTP-Referer': window.location.href,
'X-Title': 'Football-AI-Chat'
},
body: JSON.stringify({
model: MODEL_NAME,
messages: conversationHistory,
temperature: 0.7,
stream: false // استخدام وضع عدم البث لتبسيط الكود
})
});

const data = await response.json();

// إزالة مؤشر البحث
chatWindow.removeChild(searchIndicator);

if (!response.ok) {
// إذا فشل الاتصال، يتم رمي خطأ يشمل رسالة OpenRouter
const errorMessage = data.message || خطأ في API: الحالة ${response.status};
throw new Error(errorMessage);
}

finalResult = data.choices[0].message.content.trim();

} catch (error) {
// 4. معالجة الأخطاء (مثل خطأ الرصيد)
let errorMessage = 'عذراً، فشل الاتصال بالخادم. حاول مجدداً.';

if (error.message.includes('insufficient_quota') || error.message.includes('402')) {
errorMessage = ' *خطأ في البحث (قيد الرصيد):* الموديل يعمل، لكن المفتاح لا يحتوي على رصيد لتغطية تكلفة البحث على الويب ($0.02). يجب شحن رصيد بسيط لتفعيل البحث المحدث.';
} else if (error.message.includes('429')) {
errorMessage = ' *خطأ في معدل الطلبات:* يرجى الانتظار قليلاً والمحاولة مجدداً.';
} else {
errorMessage =  **خطأ غير متوقع:** ${error.message}.;
}

finalResult = errorMessage;

// إزالة مؤشر البحث في حال وجوده عند وقوع الخطأ
if (chatWindow.contains(searchIndicator)) {
chatWindow.removeChild(searchIndicator);
}
}

// 5. عرض رسالة الرد
const aiMsgDiv = createMessageElement(finalResult, 'ai');
chatWindow.appendChild(aiMsgDiv);
scrollToBottom();

// تحديث سجل المحادثة بالرد الناجح فقط
if (!finalResult.startsWith('')) {
conversationHistory.push({ role: "assistant", content: finalResult });
}

// إيقاف حالة الانتظار
isProcessing = false;
sendButton.disabled = false;
inputElement.focus();
}

// تفعيل الوظائف عند تحميل الصفحة
document.addEventListener('DOMContentLoaded', () => {
// ربط وظيفة Enter
inputElement.addEventListener('keydown', handleKeyPress);
// ربط زر الإرسال
sendButton.addEventListener('click', sendMessage);
// ربط زر المحادثة الجديدة (موجود أعلاه)
document.getElementById('new-chat-btn').addEventListener('click', newChat);
});

</script>
</body>
</html>